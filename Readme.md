# Excel游フォント変更プログラム



## 概要

本ソフトウェアは、Excelのフォントを游書体からMSゴシックに変更するためのスクリプトとExcelマクロです。



作成までの経緯はブログ記事を御覧ください。

[Excelから游ゴシック体を徹底的に駆逐する Part1](https://www.excel-chunchun.com/entry/2019/02/18/010021)

[Excelから游ゴシック体を徹底的に駆逐する Part2](https://www.excel-chunchun.com/entry/FontChange2)

[Excelから游ゴシック体を徹底的に駆逐する Part3](https://www.excel-chunchun.com/entry/FontChange3)



## 内容

- Excel_FontChange_Install.vbs
    - Excel_FontChange.vbsをタスクスケジューラに登録
    - 必要なデータ一式を「C:\Program Files\Excel_FontChange」はインストール
    - 新規作成にxlsmやxlsを追加（レジストリを変更）
- Excel_FontChange.vbs
    - テンプレートファイルを置換
    - 新規作成ファイルを置換
- ExtFontChange.bas.vba
    - ExcelVBAにインポートして使用する
    - アクティブブックの既定のフォントを統一するマクロ（游ゴシック、MSPゴシック、メイリオ）



##  お約束

- コードの安全性／正確性について、私は保証できません。

- 自己責任で利用できる人だけがご利用ください。

- Excel VBAでデバッグを行っているため、`#IF～#End IF`の配置の都合上、おかしな位置に変数の宣言があったりしますがご了承ください。

- 主に自分用コードのため、失敗事例や廃案になったモノも全てコメントで残されています。不満があればセルフサービスでお願いします。

- すべての環境に対しての動作は保証できません。（Office365 / Excel 2016 32bit/64bit で検証）

- 不具合等は詳しい環境情報とエラーメッセージを頂ければ、対処できるかもしれません。来るものは拒みませんので、遠慮なく教えてください。
- スクリプトの転用、改造、会社利用、好きにしていただいて構いませんが、差し支え無ければ引用元としてブログを紹介して頂けると幸いです。



##  インストール方法

- 必ずZIPを展開
- Excel_FontChange_Install.vbsをダブルクリック
- ユーザーアカウント制御が出るので「はい」を選択
- インストールを選択



##  アンインストール方法

- 必ずZIPを展開
- Excel_FontChange_Install.vbsをダブルクリック
- ユーザーアカウント制御が出るので「はい」を選択
- アンインストールを選択


## 既知のバグ

- 本スクリプトを使用しても、次の操作を行った場合のみ游ゴシックが復活することを確認しています。こちらの対処法は見つかっておらず、同梱しているVBAマクロなどにより対応頂く必要があります。
    1. シートを右クリック
    2. シートの移動またはコピー
    3. 移動先ブック名で「(新しいブック)」を選択
    4. OK
- 図形の変形問題は、条件次第で完全には対策しきれない場合があります。

##  作者情報

作者：ことりちゅん

Twitter：@KotorinChunChun

ブログ：<[えくせるちゅんちゅん](https://www.excel-chunchun.com/)>



##  更新履歴

| 日付     | 概要         |
| -------- | ------------ |
| 2019/6/5 | 初回リリース |
| 2020/8/23 | 64bit対応とGitHub公開とフォント相互変換に対応 |


## 謝辞

64bit対応に際して、[furyutei様](https://github.com/furyutei) が行った変更を反映させていただきました。
並びにTwitterやBlogからの指摘を元に修正を加えております。

